# =============================================================================
# Shared Configuration for Petshop Functions
# =============================================================================

# -----------------------------------------------------------------------------
# Database Configuration (Environment-based)
# -----------------------------------------------------------------------------
# Default: H2 in-memory database (development)
# Production: Azure SQL Database (via environment variables)

spring.datasource.url=${SPRING_DATASOURCE_URL:jdbc:h2:mem:petshop;DB_CLOSE_DELAY=-1}
spring.datasource.username=${SPRING_DATASOURCE_USERNAME:sa}
spring.datasource.password=${SPRING_DATASOURCE_PASSWORD:}
spring.datasource.driver-class-name=${SPRING_DATASOURCE_DRIVER_CLASS_NAME:org.h2.Driver}
spring.jpa.database-platform=${SPRING_JPA_DATABASE_PLATFORM:org.hibernate.dialect.H2Dialect}
spring.jpa.hibernate.ddl-auto=${SPRING_JPA_HIBERNATE_DDL_AUTO:update}
spring.jpa.show-sql=${SPRING_JPA_SHOW_SQL:false}

# HikariCP Connection Pool - Otimizado para Azure SQL Serverless
# minimumIdle=0 permite que conex√µes fechem quando ociosas (permite auto-pause do banco)
spring.datasource.hikari.minimum-idle=0
spring.datasource.hikari.maximum-pool-size=3
spring.datasource.hikari.idle-timeout=60000
spring.datasource.hikari.max-lifetime=300000
spring.datasource.hikari.connection-timeout=30000
spring.datasource.hikari.keepalive-time=0

# H2 Console (only for development)
spring.h2.console.enabled=${H2_CONSOLE_ENABLED:false}

# -----------------------------------------------------------------------------
# JWT Configuration
# -----------------------------------------------------------------------------
jwt.secret=${JWT_SECRET:petshop-secret-key-must-be-at-least-256-bits-long-for-HS256-algorithm}
jwt.expiration=${JWT_EXPIRATION:86400000}
jwt.issuer=${JWT_ISSUER:PetshopApi}
jwt.audience=${JWT_AUDIENCE:PetshopFrontend}

# -----------------------------------------------------------------------------
# Service URLs (for inter-service communication)
# -----------------------------------------------------------------------------
services.auth.url=${AUTH_SERVICE_URL:http://localhost:7081}
services.customers.url=${CUSTOMERS_SERVICE_URL:http://localhost:7082}
services.pets.url=${PETS_SERVICE_URL:http://localhost:7083}
services.catalog.url=${CATALOG_SERVICE_URL:http://localhost:7084}
services.scheduling.url=${SCHEDULING_SERVICE_URL:http://localhost:7085}
services.orders.url=${ORDERS_SERVICE_URL:http://localhost:7086}

# -----------------------------------------------------------------------------
# Azure Service Bus (optional)
# -----------------------------------------------------------------------------
azure.servicebus.connection-string=${SERVICEBUS_CONNECTION_STRING:}

# -----------------------------------------------------------------------------
# Logging
# -----------------------------------------------------------------------------
logging.level.com.petshop.functions=DEBUG
logging.level.org.springframework=INFO
